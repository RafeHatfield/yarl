# Scenario: Ranged Viability Arena
# Purpose: Phase 22.2 - Test ranged combat range bands at various distances
# 
# This scenario places enemies at optimal and sub-optimal ranges to validate:
#   - Full damage at optimal range (3-6 tiles)
#   - Reduced damage at close range (1-2 tiles)
#   - Reduced damage at far range (7-8 tiles)
#   - Metrics tracking for ranged attacks and damage
#
# Deterministic under seed_base=1337

metadata:
  scenario_id: ranged_viability_arena
  family: ranged_tests
  depth: 2

scenario_id: ranged_viability_arena
name: "Ranged Viability Arena"
description: "Validate ranged combat range bands: full damage at optimal, reduced at close/far."

depth: 2

defaults:
  turn_limit: 50
  player_bot: "tactical_fighter"
  allow_player_death: true
  runs: 10

expected:
  # Load-bearing metrics for ranged viability:
  # - Player should make multiple ranged attacks across runs
  # - At optimal range (3-6 tiles), full damage should be dealt
  # - Some penalty damage at far range targets
  min_ranged_attacks_made_by_player: 5
  min_ranged_damage_dealt_by_player: 10
  # Verify range bands are working (some attacks at non-optimal = some penalty)
  # Note: If all attacks at optimal range, penalty could be 0 - that's OK

suites:
  - ranged_tests
  - identity

rooms:
  - id: "ranged_arena"
    type: "arena"
    width: 20
    height: 12
    description: "Arena for testing ranged combat at various distances"
    walls: "enclosed"

monsters:
  # Optimal range targets (distance 4-6 from player at [5, 6])
  - type: "orc"
    count: 1
    position: [9, 6]   # distance 4 - optimal range
    facing: "west"
    state: "aware"
  - type: "orc"
    count: 1
    position: [11, 6]  # distance 6 - optimal range
    facing: "west"
    state: "aware"
  # Far range target (distance 7-8 from player)
  - type: "orc"
    count: 1
    position: [13, 6]  # distance 8 - extreme range (25% damage)
    facing: "west"
    state: "aware"

items:
  # Healing potions for extended combat
  - type: "healing_potion"
    count: 5
    position: [2, 2]
  - type: "healing_potion"
    count: 5
    position: [17, 9]

player:
  position: [5, 6]
  facing: "east"
  inventory: []
  equipment:
    weapon: "shortbow"  # Ranged weapon with reach 8
    armor: "leather_armor"

# Scenario design notes (Phase 22.2 - Ranged Viability):
# - Player starts at [5, 6] with shortbow equipped
# - 3 orcs at varying distances to test range bands:
#   - [9, 6]: distance 4 = optimal range (100% damage)
#   - [11, 6]: distance 6 = optimal range (100% damage)
#   - [13, 6]: distance 8 = extreme range (25% damage)
# - Expected behavior:
#   - Player should deal full damage to nearby orcs
#   - Reduced damage to far orc
#   - Metrics should track ranged attacks and damage
